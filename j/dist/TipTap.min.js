(function(a,b,c){"use strict";var d={debug:!0,device:null,CAPTURE_BUBBLE:0,CAPTURE_CAPTURE:1,_CANCEL_BUBBLING:!0,DEVICE_DEFAULT:0,DEVICE_MOUSE:1,DEVICE_TOUCH:2,GLOBAL_CLASS_FILTER:"-",_KEEP_BUBBLING:!1,listOfPointers:[],listOfRouters:[],isTouchInterface:!0,TOUCH_REFRESH_ms:1e3/60,_bindCombosToRouter:function(a,b,c){for(var d=0,e=b.length;d<e;d++){var f=b[d],g=f.combo,h=f.filter||"",i=f.callback;a.bindCombos(g,h,i,c)}},_detectTouchDevice:function(){var c=0,d=0;c++,"ontouchstart"in a&&d++,c++;try{b.createEvent("TouchEvent"),d++}catch(e){}return c++,"createTouch"in b&&d++,c++,typeof TouchEvent!="undefined"&&d++,c++,typeof Touch=="object"&&d++,c++,"ontouchend"in b&&d++,d/c>.8},disable:function(a){},enable:function(a){},_findPointerByIdentifier:function(a){return _.find(this.listOfPointers,function(b){return b.identifier===a})},_findRouter:function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(e.isOnNode$(b))return e}return null},buildNamespacedEventName:function(a){return a+".TipTap"},init:function(a){this.settings=_.extend(this.settings,a),this.isTouchInterface=this._detectTouchDevice(),this.settings.moveThreshold_px=this.isTouchInterface?8:0,this.settings.useBorisSmusPointersPolyfill?this.device=this.UnifiedPointer:this.settings.deviceType===this.DEVICE_TOUCH||this.isTouchInterface?this.device=this.Touch:this.device=this.Mouse,this.settings.use$=this.settings.use$&&!!c,this._use$(this.settings.use$),this._setCallbacks$()},_isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},on:function(a,b,c){if(!a)return this;this._isArray(a)||(a=[a]),this._isArray(b)||(b=[b]);for(var e=0,f=a.length;e<f;e++){var g=a[e],h=this._findRouter(this.listOfRouters,g);h||(h=new d.Router(g),this.listOfRouters.push(h),g.addEventListener(this.device.START_EVENT_NAME,_.bind(this.onStart,this,h))),this._bindCombosToRouter(h,b,c)}return this},$on:function(a,b,e){this._isArray(b)||(b=[b]);var f=this;return a.each(function(){var a=c(this),g=f._findRouter(f.listOfRouters,a);return g||(g=new d.Router(a),f.listOfRouters.push(g),a.bind(f.buildNamespacedEventName(f.device.START_EVENT_NAME),_.bind(f.onStart,f,g))),f._bindCombosToRouter(g,b,e),a})},onStart:function(a,b){var c=d.debug&&d.settings.debug,e=Date.now();md(this+".onStart-1: "+e+"<hr/>",c),_.reduce(this.device.buildEventList(b),_.bind(this.onStartDo,this,a),d._KEEP_BUBBLING,this)===d._CANCEL_BUBBLING&&this.stopEvent(b),md(this+".onStart-2: "+(Date.now()-e)+" ms",c)},onStartDo:function(a,b,c){var e=d.debug&&d.settings.debug,f,g;return md(this+".onStartDo-1",e),g=a.findMatchingFilterForEvent(c.getTarget$()),g?(md(this+".onStartDo-2",e),f=new d.Pointer(c),this.listOfPointers.push(f),a.allocateAction(f),md(this+".onStartDo-3",e),this.device.onStart(),f.onStart(c),md(this+".onStartDo-4",e),d._CANCEL_BUBBLING):b},onDrag:function(a){var b=!1,c=d._KEEP_BUBBLING,e=Date.now();if(!this.device.shouldCaptureDrag())return;this.device.onDrag(a),_.each(this.device.buildEventList(a),function(f){var g=this._findPointerByIdentifier(f.identifier);if(!g)return;md(this+".onDrag: "+e+",l="+this.device.buildEventList(a).length+"<hr/>",b),c=d._CANCEL_BUBBLING,g.onDrag(f)},this),c&&this.stopEvent(a)},onEnd:function(a){var b=d.debug&&d.settings.debug;_.reduce(this.device.buildEventList(a),_.bind(this.onEndDo,this),d._KEEP_BUBBLING,this)&&(md(this+".onEnd",b,"#F00"),this.stopEvent(a))},onEndDo:function(a,b){var c=d.debug&&d.settings.debug,e=this._findPointerByIdentifier(b.identifier);return e?(md(this+".onEndDo",c,"#F00"),this.device.onEnd(b),e.onEnd(b),this.unlinkPointer(e),d._CANCEL_BUBBLING):a},onCancel:function(a){md(this+".onCancel",debug),this.onEnd(a)},_setCallbacks$:null,_setCallbacks:function(){b.addEventListener(this.device.DRAG_EVENT_NAME,_.bind(this.onDrag,this)),b.addEventListener(this.device.END_EVENT_NAME,_.bind(this.onEnd,this)),b.addEventListener(this.device.CANCEL_EVENT_NAME,_.bind(this.onCancel,this))},_set$Callbacks:function(){c(b).bind(this.buildNamespacedEventName(this.device.DRAG_EVENT_NAME),_.bind(this.onDrag,this)).bind(this.buildNamespacedEventName(this.device.END_EVENT_NAME),_.bind(this.onEnd,this)).bind(this.buildNamespacedEventName(this.device.CANCEL_EVENT_NAME),_.bind(this.onCancel,this))},stopEvent:function(a){a.preventDefault()},toString:function(){return"TipTap"},unlinkPointer:function(a){var b=d.debug&&d.settings.debug,c=this.listOfPointers.length;this.listOfPointers.splice(this.listOfPointers.indexOf(a),1),md(this+".unlinkPointer: "+c+" -> "+this.listOfPointers.length,b)},_use$:function(a){this._setCallbacks$=a?this._set$Callbacks:this._setCallbacks,this.device.use$(a),this.Action.use$(a),this.Pointer.use$(a),this.PointerInfos.use$(a),this.Router.use$(a)}};d.settings={comboAlternateOperator:"|",comboEndTimer_ms:100,comboGesturesSep:">",comboParallelActionOperator:"-",debug:!0,deviceType:d.DEVICE_MOUSE,moveThreshold_px:0,rotoZoom:!1,simultaneousMovesTimer_ms:3*d.TOUCH_REFRESH_ms,swipeDuration_ms:8*d.TOUCH_REFRESH_ms,swipeMaxDistance_px:160,swipeMinDisplacement_px:16,tapMaxDuration_ms:150,useBorisSmusPointersPolyfill:!1,use$:!1,useTipPrefixes:!1},a.TipTap=d;var e={activate:function(){return d.activate(this)},on:function(a,b,c,e){return d.$on(this,a,b,c,e)},deactivate:function(){return d.deactivate(this)},off:function(){}};c&&(c.fn.tipTap=function(a,b,d,f){if(e[a])return e[a].apply(this,Array.prototype.slice.call(arguments,1));if(typeof a=="object"||!a)return e.init.apply(this,arguments);c.error("Method "+a+" does not exist in jQuery.tipTap")})})(window,document,window.jQuery);var md=function(){var a=$("#debuglog");return function(b,c,d){c&&(d&&(b='<span style="color: '+d+'; ">'+b+"</span>"),a.prepend(b+"<br/>"))}}();(function(a,b){var c=function(a){this.effects={},this.initialState="",this.state="",a||(a=c.SAVE_STATE),this.saveState=a};c._SELF="_self",c._CALC="_calc",c.SAVE_STATE=!1,c.DONT_SAVE_STATE=!0,c.prototype={doTransition:function(a,b){var d,e,f;this.saveState===c.SAVE_STATE?f=this:(f=a,f.state||(f.state=this.initialState)),d=this.effects[f.state+b];if(!d)return;e=d.action.apply(a,Array.prototype.slice.call(arguments,2))||c._SELF;if(d.to===c._SELF)return;if(d.to===c._CALC){if(e===c._SELF)return;f.state=e}else f.state=d.to},init:function(a){return b.each(a,function(a){this.state||(this.state=a.from),a.isStart&&(this.state=this.initialState=a.from),this.parseState(a)},this),this.initialState},parseState:function(a){b.each(a.transitions,function(c){var d=c.signal;typeof d=="string"&&(d=[d]),b.each(d,function(b){this.storeTransition(a.from,c,b)},this)},this)},storeTransition:function(a,b,d){this.effects[a+d]={action:b.action,to:b.to||c._SELF},this[d]=function(a){return function(){var b=[this,d].concat(Array.prototype.slice.call(arguments));return a.doTransition.apply(a,b)}}(this)},toString:function(){return"FSM"}},a.Fsm=c})(window.TipTap,_),function(a,b){var c=function(b,d){var e=c.debug&&a.settings.debug;this.id=c.id(),this.status=b,this.direction=d,this.listOfPointers=[],this.birthTime=Date.now(),md(this+".new("+c.statusMatchCode[c.getFullStatus(this.status,this.direction)].code+")",e,c.debugColor)};c.prototype={toString:function(){return"--G#"+this.id+"-"+c.statusMatchCode[this.status].code}},c.debug=!0,c.debugColor="#"+Math.round(Math.random()*Math.pow(2,24)).toString(16),c.formatGesture=function(b,d,e){var f=c.debug&&a.settings.debug,g,h="",i;arguments.length===2&&(e=d,d=a.Pointer._DIR_NONE),i=c.getMatchCode(b,d);if(!e)return"";for(g=0;g<e;g++)h+=i;return md("Gesture.formatGesture: "+h,f),h},c.getMatchCode=function(a,b){return c.statusMatchCode[c.getFullStatus(a,b)].letter},c.getFullStatus=function(b,d){if(b!==c._SWIPED)return b;switch(d){case a.Pointer._DIR_TOP:return c._SWIPED_T;case a.Pointer._DIR_BOTTOM:return c._SWIPED_B;case a.Pointer._DIR_LEFT:return c._SWIPED_L;default:return c._SWIPED_R}},c.id=function(){return c._id++,c._id},c._id=0,c._VOID=0,c._PRESSED=c._VOID+1,c._TAPPED=c._PRESSED+1,c._UNTIPPED=c._TAPPED+1,c._TIPPED=c._UNTIPPED+1,c._DRAG_STARTED=c._TIPPED+1,c._DRAG_STOPPED=c._DRAG_STARTED+1,c._DRAGGED=c._DRAG_STOPPED+1,c._RELEASED=c._DRAGGED+1,c._SWIPED_T=c._RELEASED+1,c._SWIPED_R=c._SWIPED_T+1,c._SWIPED_B=c._SWIPED_R+1,c._SWIPED_L=c._SWIPED_B+1,c._SWIPED=c._SWIPED_L+1,c.statusMatchCode=[],c.statusMatchCode[c._VOID]={code:"void",letter:"A"},c.statusMatchCode[c._PRESSED]={code:"press",letter:"B"},c.statusMatchCode[c._TAPPED]={code:"tap",letter:"C"},c.statusMatchCode[c._UNTIPPED]={code:"untip",letter:"D"},c.statusMatchCode[c._TIPPED]={code:"tip",letter:"E"},c.statusMatchCode[c._DRAG_STARTED]={code:"dragStart",letter:"F"},c.statusMatchCode[c._DRAG_STOPPED]={code:"dragStop",letter:"G"},c.statusMatchCode[c._DRAGGED]={code:"drag",letter:"H"},c.statusMatchCode[c._RELEASED]={code:"release",letter:"I"},c.statusMatchCode[c._SWIPED_T]={code:"swipe_t",letter:"J"},c.statusMatchCode[c._SWIPED_R]={code:"swipe_r",letter:"K"},c.statusMatchCode[c._SWIPED_B]={code:"swipe_b",letter:"L"},c.statusMatchCode[c._SWIPED_L]={code:"swipe_l",letter:"M"},c.statusMatchCode[c._SWIPED]={code:"swipe",letter:"N"},a.Gesture=c}(window.TipTap,_),function(a,b){var c=function(b,d){var e=c.debug&&a.settings.debug;this.id=c.id(),this.status=b,this.direction=d,this.listOfPointers=[],this.birthTime=Date.now(),md(this+".new("+a.Gesture.statusMatchCode[a.Gesture.getFullStatus(this.status,this.direction)].code+")",e,c.debugColor)};c.prototype={addPointer:function(a){var b=this.listOfPointers.length,c=0;while(c<b&&this.listOfPointers[c].identifier<a.identifier)c++;c===b?this.listOfPointers.push(a):this.listOfPointers.splice(c,0,a)},age:function(){return Date.now()-this.birthTime},canThisPointerBeAdded:function(b){var d=c.debug&&a.settings.debug;return md(this+".canThisPointerBeAdded("+a.Gesture.statusMatchCode[a.Gesture.getFullStatus(this.status,this.direction)].code+" =?= "+a.Gesture.statusMatchCode[a.Gesture.getFullStatus(b.status,b.direction)].code+", "+b.identifier+")",d,c.debugColor),this.status===b.status&&this.direction===b.direction&&!this.hasThisPointerAlready(b)},format:function(){var b=c.debug&&a.settings.debug,d=a.Gesture.formatGesture(this.status,this.direction,this.getPointersCount());return md(this+".format: "+d,b,c.debugColor),d},getPointer:function(a){return a<0?null:a>=this.listOfPointers.length?null:this.listOfPointers[a]},hasThisPointerAlready:function(d){var e=c.debug&&a.settings.debug,f;return f=b.find(this.listOfPointers,function(a){return a.identifier===d.identifier}),md(this+".hasThisPointerAlready => "+f,e,c.debugColor),f},isEmpty:function(){return!this.listOfPointers.length},getPointersCount:function(){return this.listOfPointers.length},toString:function(){return"--H#"+this.id+"-"+a.Gesture.statusMatchCode[this.status].code}},c.debug=!0,c.debugColor="#"+Math.round(Math.random()*Math.pow(2,24)).toString(16),c.id=function(){return c._id++,c._id},c._id=0,a.Hics=c}(window.TipTap,_),function(a,b){var c=function(b){var d=!1;this.boundEndComboAndMaybeAction=null,this.endComboAndMaybeActionTimer=0,this.fifoOfHics=[],this.gesture=null,this.id=c.id(),this.listOfFormattedGestures=[],this.listOfPointers=null,this.pressedPointersCount=0,this.processHicsTimer=0,this.target=null,this.$target=null,this._setTarget$(b),md(this+".new("+(this.target?this.target.id:this.$target[0].id)+'")',d),a.settings.rotoZoom&&(this.rotoZoomer=new a.RotoZoomer(b,!0,!0,!0)),this.createSignals()};c.prototype={addPointerListeners:function(c){c.pressed.add(b.bind(this.allocateHics,this,a.Gesture._PRESSED,c),this),c.tapped.add(b.bind(this.allocateHics,this,a.Gesture._TAPPED,c),this),c.tipped.add(b.bind(this.allocateHics,this,a.Gesture._TIPPED,c),this),c.untipped.add(b.bind(this.allocateHics,this,a.Gesture._UNTIPPED,c),this),c.swiped.add(b.bind(this.allocateHics,this,a.Gesture._SWIPED,c),this),c.dragStarted.add(b.bind(this.allocateHics,this,a.Gesture._DRAG_STARTED,c),this),c.dragged.add(b.bind(this.allocateHics,this,a.Gesture._DRAGGED,c),this),c.dragStopped.add(b.bind(this.allocateHics,this,a.Gesture._DRAG_STOPPED,c),this),c.released.add(b.bind(this.allocateHics,this,a.Gesture._RELEASED,c),this)},allocateHics:function(d,e){var f=c.debug&&a.settings.debug;md(this+".allocateHics-1("+a.Gesture.statusMatchCode[d].code+")",f);var g=new a.PointerInfos(e,d);d===a.Gesture._PRESSED&&this.cancelSendComboAndEndActionTimer();var h=b.find(this.fifoOfHics,function(a){return a.canThisPointerBeAdded(g)},this);return h||(md(this+".allocateHics-must create new Hics",f),h=new a.Hics(d,e.getDirection()),this.storeHics(h)),this.startHicsListProcessingTimer(),md(this+".allocateHics-4",f),h.addPointer(g),h},buildAndSendNotificationGesture:function(a){this.gesture=a,this.listOfPointers=a.listOfPointers,this.sendCombo.dispatch(this.includeHicsInGesture(a))},buildComboClearGesturesAndSendCombo:function(b){var d=c.debug&&a.settings.debug,e=this.listOfFormattedGestures.join(a.settings.comboGesturesSep);md(this+".buildComboClearGesturesAndSendCombo-1:["+e+"]",d),this.clearListOfFormattedGestures(),this.sendCombo.dispatch(e,b)},cancelSendComboAndEndActionTimer:function(){var b=c.debug&&a.settings.debug;md(this+".cancelSendComboAndEndActionTimer-1",b,""),this.endComboAndMaybeActionTimer&&(md(this+".cancelSendComboAndEndActionTimer-clearTimeout",b,""),clearTimeout(this.endComboAndMaybeActionTimer),this.endComboAndMaybeActionTimer=0)},clearListOfFormattedGestures:function(){this.listOfFormattedGestures.length=0},consumeDoneHicsFromFIFO:function(){var b=c.debug&&a.settings.debug,d;this.processHicsTimer=0,md(this+".consumeDoneGesturesFromFIFO-1",b);var e=a.Gesture.statusMatchCode;while(this.fifoOfHics.length){d=this.fifoOfHics[0],md(this+".consumeDoneGesturesFromFIFO-treating("+d+"."+d.status+")",b);if(a.settings.simultaneousMovesTimer_ms>d.age()&&d.status!==a.Gesture._DRAGGED){md(this+".consumeDoneGesturesFromFIFO-too young and != 'dragged', EXITING",b),this.startHicsListProcessingTimer();return}this.fifoOfHics.shift(),this[e[d.status].code].call(this,d)}},createSignals:function(){var a=signals.Signal;this.pressed=new a,this.sendCombo=new a,this.dragStarted=new a,this.dragged=new a,this.dragStopped=new a,this.released=new a,this.finished=new a},endComboAndMaybeAction:function(b){var d=c.debug&&a.settings.debug;md(this+".endComboAndMaybeAction-1("+this.endComboAndMaybeActionTimer+", "+b+")",d,""),this.endComboAndMaybeActionTimer=0,this.buildComboClearGesturesAndSendCombo(b),this.terminateIfEmpty()},flushPreviousGesture:function(){this.boundEndComboAndMaybeAction&&this.boundEndComboAndMaybeAction(),this.boundEndComboAndMaybeAction=null},includeHicsInGesture:function(b){var d=c.debug&&a.settings.debug,e,f=b.format();return a.settings.useTipPrefixes&&(e=a.Gesture.formatGesture(a.Gesture._TIPPED,this.pressedPointersCount),e&&(f=e+a.settings.comboParallelActionOperator+f)),md(this+".formatGesture-1("+f+")",d),f},formatAndStoreGesture:function(b){var d=c.debug&&a.settings.debug;md(this+".formatAndStoreGesture("+b+","+this.includeHicsInGesture(b)+")",d,"#F00"),this.listOfFormattedGestures.push(this.includeHicsInGesture(b))},getPointer:function(a){return this.gesture.getPointer(a)},getTarget$:null,getTarget:function(){return this.target},get$Target:function(){return this.$target},hasPressedPointers:function(){return this.pressedPointersCount>0},_setTarget$:null,_setTarget:function(a){this.target=a},_set$Target:function(a){this.$target=a},startHicsListProcessingTimer:function(){var d=c.debug&&a.settings.debug;if(this.processHicsTimer){md(this+".startProcessGestureTimer-no need to start timer",d);return}this.processHicsTimer=setTimeout(b.bind(this.consumeDoneHicsFromFIFO,this),a.settings.simultaneousMovesTimer_ms/4),md(this+".startProcessGestureTimer-timer started("+this.processHicsTimer+")",d)},startSendComboAndEndActionTimer:function(d){var e=c.debug&&a.settings.debug;this.boundEndComboAndMaybeAction=b.bind(this.endComboAndMaybeAction,this,d),this.endComboAndMaybeActionTimer=setTimeout(this.boundEndComboAndMaybeAction,a.settings.comboEndTimer_ms),md(this+".startSendComboAndEndActionTimer-1("+d+", "+this.endComboAndMaybeActionTimer+")",e,"")},storeHics:function(a){this.fifoOfHics.push(a)},terminateIfEmpty:function(){var b=c.debug&&a.settings.debug;if(this.hasPressedPointers())return;md(this+".terminateIfEmpty-1",b),this.finished.dispatch()},toString:function(){return"-A#"+this.id},zoomElement:function(){var b=c.debug&&a.settings.debug,d=this.$target,e,f;e=this.fingersBoundingBox,f=this.elementGeometry,d.width(e.width+f.width).height(e.height+f.height),d.offset({left:e.left+f.left,top:e.top+f.top})}};var d=a.Gesture,e=d.statusMatchCode;c.prototype[e[d._PRESSED].code]=function(b){a.settings.rotoZoom&&this.rotoZoomer.onPressed(b),this.buildAndSendNotificationGesture(b)},c.prototype[e[d._SWIPED].code]=c.prototype[e[d._TAPPED].code]=function(a){this.cancelSendComboAndEndActionTimer(),this.formatAndStoreGesture(a),this.startSendComboAndEndActionTimer(a)},c.prototype[e[d._TIPPED].code]=function(b){var d=c.debug&&a.settings.debug;this.formatAndStoreGesture(b),this.pressedPointersCount+=b.getPointersCount(),this.buildComboClearGesturesAndSendCombo(b)},c.prototype[e[d._UNTIPPED].code]=function(b){var d=c.debug&&a.settings.debug;this.pressedPointersCount-=b.getPointersCount(),this.cancelSendComboAndEndActionTimer(),this.flushPreviousGesture(),this.formatAndStoreGesture(b),this.buildComboClearGesturesAndSendCombo(b),this.terminateIfEmpty()},c.prototype[e[d._DRAG_STARTED].code]=function(a){this.buildAndSendNotificationGesture(a)},c.prototype[e[d._DRAGGED].code]=function(b){var d=c.debug&&a.settings.debug;md(this+".drag",d),a.settings.rotoZoom&&this.rotoZoomer.onDrag(b),this.gesture=b,this.dragged.dispatch(b.format())},c.prototype[e[d._DRAG_STOPPED].code]=function(b){a.settings.rotoZoom&&this.rotoZoomer.onStoppedDragging(b),this.buildAndSendNotificationGesture(b)},c.prototype[e[d._RELEASED].code]=function(b){a.settings.rotoZoom&&this.rotoZoomer.onReleased(b),this.buildAndSendNotificationGesture(b)},c.debug=!0,c.id=function(){return c._id++,c._id},c._id=0,c.use$=function(a){a?(this.prototype._setTarget$=this.prototype._set$Target,this.prototype.getTarget$=this.prototype.get$Target):(this.prototype._setTarget$=this.prototype._setTarget,this.prototype.getTarget$=this.prototype.getTarget)},a.Action=c}(window.TipTap,_),function(a,b){var c=function(b){var d=c.debug&&a.settings.debug;this.direction=c._DIR_NONE,this.identifier=b.identifier,this.isTipping=!1,this.listOfPositions=[],this.dragDetailsAbsolute={dx:0,dy:0,d:0,spx:0,spy:0,spd:0,duration_ms:0},this.dragDetailsRelative={dx:0,dy:0,d:0,spx:0,spy:0,spd:0,duration_ms:0},this.pressedToTippedTimer=0,this.swipeStartPositionIndex=0,this.target=this.$target=null,this._setTarget$(b.getTarget$()),this.createSignals(),this.storePosition(b),md(this+".new()",d)};c.fsm=new a.Fsm(a.Fsm.DONT_SAVE_STATE),c.fsm.init([{from:"start",isStart:!0,transitions:[{signal:"pressed",to:"pressing",action:function(){var b=c.debug&&a.settings.debug,d=this.getPosition();this.startPressedToTippedTimer(),this.pressed.dispatch(),md(this+"-fsm(start-pressed-pressing),("+d.pageX+"px, "+d.pageY+"px)",b)}}]},{from:"pressing",transitions:[{signal:"pressedToTipped",to:"tipping",action:function(){var b=c.debug&&a.settings.debug;md(this+"-fsm(pressing-pressedToTipped-tipping)",b),this.isTipping=!0,this.tipped.dispatch()}},{signal:"dragged",to:a.Fsm._CALC,action:function(){return this.fsmDraggedTransition()}},{signal:["ended","cancelled"],to:"end",action:function(){var b=c.debug&&a.settings.debug;this.cancelPressedToTippedTimer(),md(this+"-fsm(pressing-ended-end)",b),this.tapped.dispatch(),this.released.dispatch()}}]},{from:"tipping",transitions:[{signal:"dragged",to:a.Fsm._CALC,action:function(){return this.fsmDraggedTransition()}},{signal:["ended","cancelled"],to:"end",action:function(){var b=c.debug&&a.settings.debug;md(this+"-fsm(tipping-ended)",b),this.untipped.dispatch(),this.released.dispatch()}}]},{from:"dragging",transitions:[{signal:"dragged",action:function(){var b=c.debug&&a.settings.debug;md(this+"-fsm(dragging-dragged-1)",b),this.dragged.dispatch()}},{signal:["ended","cancelled"],to:"end",action:function(){var b=c.debug&&a.settings.debug;this.dragStopped.dispatch(),md(this+"-fsm(dragging-ended-1)",b),this.isTipping&&this.untipped.dispatch(),this.released.dispatch()}}]},{from:"swiping",transitions:[{signal:"dragged",to:a.Fsm._CALC,action:function(){var b=c.debug&&a.settings.debug;return this.notSwipingAnymore()?(this.dragStarted.dispatch(),md(this+"-fsm(swiping-dragged-1)",b),this.dragged.dispatch(),"dragging"):a.Fsm._SELF}},{signal:["ended","cancelled"],to:"end",action:function(){var b=c.debug&&a.settings.debug;md(this+"-fsm(swiping-ended-1)",b),this.swiped.dispatch(),this.isTipping&&this.untipped.dispatch(),this.released.dispatch()}}]}]),c._DIR_NONE=0,c._DIR_TOP=1,c._DIR_RIGHT=2,c._DIR_BOTTOM=4,c._DIR_LEFT=8,c.prototype={addPosition:function(a){this.listOfPositions.push(a)},cancelPressedToTippedTimer:function(){var b=c.debug&&a.settings.debug;md(this+".cancelPressedToTippedTimer-1",b),this.pressedToTippedTimer&&(md(this+".cancelPressedToTippedTimer-2",b),clearTimeout(this.pressedToTippedTimer),this.pressedToTippedTimer=0)},_computeMove:function(a,b){var c=this.listOfPositions[a],d=this.listOfPositions[b],e=d.pageX-c.pageX,f=d.pageY-c.pageY,g=Math.sqrt(e*e+f*f),h=d.timeStamp-c.timeStamp,i=e/h,j=f/h,k=g/h;return{dx:e,dy:f,d:g,spx:i,spy:j,spd:k,duration_ms:h}},computeAbsMove:function(){return this._computeMove(0,this.listOfPositions.length-1)},computeRelMove:function(){return this._computeMove(this.listOfPositions.length-2,this.listOfPositions.length-1)},createSignals:function(){var a=signals.Signal;this.pressed=new a,this.tapped=new a,this.tipped=new a,this.untipped=new a,this.swiped=new a,this.dragStarted=new a,this.dragged=new a,this.dragStopped=new a,this.released=new a},fsmDraggedTransition:function(){var b=c.debug&&a.settings.debug,d;return this.wasAnUncontrolledMove()?a.Fsm._SELF:(md(this+"-fsm(pressing-dragged-1)",b),this.cancelPressedToTippedTimer(),d=this.isSwipingOrDragging(),md(this+"-fsm(pressing-dragged-2)",b),d==="swiping"?d:(md(this+"-fsm(pressing-dragged-3)",b),this.dragStarted.dispatch(),this.dragged.dispatch(),"dragging"))},getDirection:function(){return this.direction},getInitialPosition:function(){return this.listOfPositions[0]},getPosition:function(){return this.listOfPositions[this.listOfPositions.length-1]},getState:function(){return this.state},getTarget$:null,getTarget:function(){return this.target},get$Target:function(){return this.$target},isSwipingOrDragging:function(){var b=c.debug&&a.settings.debug,d=a.settings,e,f,g,h;e=this.dragDetailsRelative.dx,g=Math.abs(e),f=this.dragDetailsRelative.dy,h=Math.abs(f),md(this+".isSwipingOrDragging-2",b);if(g>=h){md(this+".isSwipingOrDragging, adx: "+g,b,"#0F0");if(g>=d.swipeMinDisplacement_px)return e>0?(md(this+".isSwipingOrDragging > swipe-r",b),this.direction=c._DIR_RIGHT):(md(this+".isSwipingOrDragging > swipe-l",b),this.direction=c._DIR_LEFT),this.swipeStartPositionIndex=this.listOfPositions.length-1,"swiping"}else if(h>=d.swipeMinDisplacement_px)return f>0?(md(this+".isSwipingOrDragging > swipe-b",b),this.direction=c._DIR_BOTTOM):(md(this+".isSwipingOrDragging > swipe-t",b),this.direction=c._DIR_TOP),this.swipeStartPositionIndex=this.listOfPositions.length-1,"swiping";return"tipping"},notSwipingAnymore:function(){var b=c.debug&&a.settings.debug,d=a.settings;return md(this+".notSwipingAnymore: "+this.dragDetailsAbsolute.duration_ms+"ms, "+this.dragDetailsAbsolute.d+"px",b),this._computeMove(this.swipeStartPositionIndex,this.listOfPositions.length-1).duration_ms>d.swipeDuration_ms||this.dragDetailsAbsolute.d>d.swipeMaxDistance_px},onDrag:function(b){var d=c.debug&&a.settings.debug;this.storePosition(b),this.dragDetailsAbsolute=this.computeAbsMove(),this.dragDetailsRelative=this.computeRelMove(),c.fsm.dragged.call(this)},onEnd:function(a){this.storePosition(a),c.fsm.ended.call(this)},onStart:function(){c.fsm.pressed.call(this)},pressedToTipped:function(){c.fsm.pressedToTipped.call(this)},_setTarget$:null,_setTarget:function(a){this.target=a},_set$Target:function(a){this.$target=a},startPressedToTippedTimer:function(){var d=c.debug&&a.settings.debug;md(this+".startPressedToTippedTimer-1",d),this.pressedToTippedTimer||(md(this+".startPressedToTippedTimer-2",d),this.pressedToTippedTimer=setTimeout(b.bind(this.pressedToTipped,this),a.settings.tapMaxDuration_ms))},storePosition:function(b){this.addPosition(new a.Position(b))},toString:function(){return"---Ptr#"+this.identifier},wasAnUncontrolledMove:function(){var b=!1,d=a.settings;return md(this+".wasAnUncontrolledMove("+Math.abs(this.dragDetailsAbsolute.dx)+"px, "+Math.abs(this.dragDetailsAbsolute.dy)+"px)",b),Math.abs(this.dragDetailsAbsolute.dx)<=d.moveThreshold_px&&Math.abs(this.dragDetailsAbsolute.dy)<=d.moveThreshold_px}},c.debug=!0,c.use$=function(a){a?(this.prototype.getTarget$=this.prototype.get$Target,this.prototype._setTarget$=this.prototype._set$Target):(this.prototype.getTarget$=this.prototype.getTarget,this.prototype._setTarget$=this.prototype._setTarget)},a.Pointer=c}(window.TipTap,_),function(a){Mouse={START_EVENT_NAME:"mousedown",DRAG_EVENT_NAME:"mousemove",END_EVENT_NAME:"mouseup",CANCEL_EVENT_NAME:"mousecancel",mouseDown:!1,buildEventList:function(b){return b.button!==0?[]:[new a.MouseEvent(b)]},onStart:function(a){this.mouseDown=!0},onDrag:function(a){},onEnd:function(a){this.mouseDown=!1},onCancel:function(a){this.onEnd(a)},shouldCaptureDrag:function(){return this.mouseDown},use$:function(b){a.MouseEvent.use$(b)}},a.Mouse=Mouse}(window.TipTap),function(a,b){MouseEvent=function(a){this.identifier=1,this.pageX=a.pageX,this.pageY=a.pageY,this.target=null,this.$target=null,this._setTarget$FromEvent(a),this.timeStamp=a.timeStamp},MouseEvent.prototype={getTarget$:null,getTarget:function(){return this.target},get$Target:function(){return this.$target},_setTarget$FromEvent:null,_setTargetFromEvent:function(a){this.target=a.target},_set$TargetFromEvent:function(a){this.$target=b(a.target)}},MouseEvent.use$=function(a){a?(this.prototype._setTarget$FromEvent=this.prototype._set$TargetFromEvent,this.prototype.getTarget$=this.prototype.get$Target):(this.prototype._setTarget$FromEvent=this.prototype._setTargetFromEvent,this.prototype.getTarget$=this.prototype.getTarget)},a.MouseEvent=MouseEvent}(window.TipTap,window.jQuery),function(a,b){var c=function(a,b){this.identifier=a.identifier,this.target=null,this.$target=null,this._setTarget$(a.getTarget$()),this.pageX=a.getPosition().pageX,this.pageY=a.getPosition().pageY,this.status=b,this.direction=a.getDirection()};c.prototype={getTarget$:null,getTarget:function(){return this.target},get$Target:function(){return this.$target},_setTarget$:null,_setTarget:function(a){this.target=a},_set$Target:function(a){this.$target=a},toString:function(){return"Ptr#"+this.identifier}},c.use$=function(a){a?(this.prototype._setTarget$=this.prototype._set$Target,this.prototype.getTarget$=this.prototype.get$Target):(this.prototype._setTarget$=this.prototype._setTarget,this.prototype.getTarget$=this.prototype.getTarget)},a.PointerInfos=c}(window.TipTap,_),function(a){var b=function(a){this.timeStamp=a.timeStamp,this.pageX=a.pageX,this.pageY=a.pageY};b.prototype={toString:function(){return"Pos#"+this.identifier+"("+this.pageX+","+this.pageY+")"}},a.Position=b}(window.TipTap),function(a,b){var c=function(b,d,e,f){var g=c.debug&&a.settings.debug;this.$target=b,this.target=b[0],this.touches=[],b.data("rotoZoomer-matrix")?(this.matrix=b.data("rotoZoomer-matrix").split(","),this.rotateable=b.data("rotoZoomer-rotateable"),this.zoomable=b.data("rotoZoomer-zoomable"),this.autoApply=b.data("rotoZoomer-autoapply"),md("<b>"+this+".new, data read(m: ["+b.data("rotoZoomer-matrix")+"], rotateable: "+b.data("rotoZoomer-rotateable")+", zoomable: "+b.data("rotoZoomer-zoomable")+", autoApply: "+b.data("rotoZoomer-autoapply")+")</b>",g)):(this.matrix=[1,0,0,1,0,0],this.rotateable=d,this.zoomable=e,this.autoApply=f,md("<b>"+this+".new, data (m: [1, 0, 0, 1, 0, 0], rotateable: "+d+", zoomable: "+e+", autoApply: "+f+")</b>",g),this.touchDist=0,this.touchRot=0,this.setTransform(0,1,0,0))};c.prototype={addTouch:function(a){var b=this.touches,c=b.length,d=0;while(d<c&&b[d].identifier<a.identifier)d++;d===c?b.push(a):b.splice(d,0,a)},getTouchVector:function(b,d){var e=c.debug&&a.settings.debug;md(this+".getTouchVector-1",e),md(this+".getTouchVector-1(x1: "+b.pageX+", y1: "+b.pageY+", x2: "+d.pageX+", y2: "+d.pageY+")",e);var f={x:d.pageX-b.pageX,y:d.pageY-b.pageY};return f.length=Math.sqrt(f.x*f.x+f.y*f.y),f.rotation=Math.atan2(f.y,f.x),f.cx=d.pageX+f.x/2,f.cy=d.pageY+f.y/2,md(this+".getTouchVector-2: l: "+f.length+", r: "+f.rotation+", cx: "+f.cx+", cy: "+f.cy,e),f},onDrag:function(b){var d=c.debug&&a.settings.debug;md(this+".onDrag-1",d);var e=b.listOfPointers,f,g,h,i,j;e.length>=2&&(md(this+".onDrag-2",d),f=this.getTouch(e[0].identifier),g=this.getTouch(e[1].identifier),j=this.getTouchVector({pageX:e[0].pageX,pageY:e[0].pageY},{pageX:e[1].pageX,pageY:e[1].pageY}),md(this+".onDrag-2, vector.length = "+j.length+", vector.rotation = "+j.rotation,d),i=j.length/this.touchDist,md(this+".onDrag-2, this.touchDist = "+this.touchDist+", this.touchRot = "+this.touchRot,d),this.rotateable&&(h=this.touchRot-j.rotation),md(this+".onDrag-3(rot:"+h+", zoom:"+i+")",d),this.setMatrix(h,i,0,0),md(this+".onDrag-4",d),this.applyTransform()),md(this+".onDrag-end",d)},onPressed:function(d){var e=c.debug&&a.settings.debug,f=d.listOfPointers,g,h,i,j;b.each(f,function(a){this.setTouchPos(a)},this);var k=this.touches;md(this+".onPressed: lopl = "+f.length,e);if(k.length>=2){g=k[0];for(var l in g)g.hasOwnProperty(l)&&md(this+".onPressed:touch0 = "+l,e);h=k[1],md(this+".onPressed: calc vector()",e),j=this.getTouchVector(g,h),md(this+".onPressed: calc transform()",e),i=this.getTransform(),this.touchDist=j.length/i.scale,md(this+".onPressed: touchDist = "+this.touchDist,e),this.rotateable&&(this.touchRot=i.rotation+j.rotation)}md(this+".onStartedDragging-2",e)},onReleased:function(d){var e=c.debug&&a.settings.debug;b.each(d.listOfPointers,function(a){md(this+".onReleased, removing:"+a,e),this.unsetTouchPos(a)},this)},onStoppedDragging:function(b){var d=c.debug&&a.settings.debug,e=b.listOfPointers,f,g=e.length,h=this.$target;md(this+".onStoppedDragging-1",d);for(f=0;f<g;f++)this.unsetTouchPos(e[f]);h.data("rotoZoomer-matrix",this.matrix.join(",")),h.data("rotoZoomer-rotateable",this.rotateable),h.data("rotoZoomer-zoomable",this.zoomable),h.data("rotoZoomer-autoapply",this.autoApply),md(this+".onStoppedDragging-2, data read(m: ["+h.data("rotoZoomer-matrix")+"], rotateable: "+h.data("rotoZoomer-rotateable")+", zoomable: "+h.data("rotoZoomer-zoomable")+", autoApply: "+h.data("rotoZoomer-autoapply")+")",d)},setTouchPos:function(b){var d=c.debug&&a.settings.debug;md(this+".setTouchPos-1",d);var e=this.globalToLocal(b),f={identifier:b.identifier,localX:e.localX,localY:e.localY,pageX:b.pageX,pageY:b.pageY};this.addTouch(f),md(this+".setTouchPos-4",d)},unsetTouchPos:function(a){var b=this.touches,c=b.length,d=0;while(d<c&&b[d].identifier!==a.identifier)d++;d<c&&b.splice(d,1)},getTouch:function(a){return b.find(this.touches,function(b){return a===b.identifier})},getTouchPos:function(a){var b=this.getTouch(a);return b||(b={identifier:a,localX:0,localY:0,pageX:0,pageY:0},this.addTouch(b)),this.localToGlobal(b)},applyTransform:function(){var b=c.debug&&a.settings.debug,d="matrix("+this.matrix.join(",")+")";this.autoApply&&(md(this+".autoApply",b),this.target.style.WebkitTransform=d,this.target.style.OTransform=d,this.target.style.MozTransform=d)},setTransform:function(a,b,c,d){this.setMatrix(a,b,c,d),this.applyTransform()},getTransform:function(){var a=this.matrix[0],b=this.matrix[2],c=Math.atan(b/a),d=a/Math.cos(c);return{scale:d,rotation:c}},setMatrix:function(b,d,e,f){var g=c.debug&&a.settings.debug;this.matrix[0]=Math.cos(b)*d,this.matrix[2]=Math.sin(b)*d,this.matrix[1]=-Math.sin(b)*d,this.matrix[3]=Math.cos(b)*d,this.matrix[4]=e,this.matrix[5]=f,md(this+".setMatrix(["+this.matrix.join(",")+"])",g)},localToGlobal:function(a){var b=this.matrix[0]*a.localX+this.matrix[2]*a.localY+1*this.matrix[4],c=this.matrix[1]*a.localX+this.matrix[3]*a.localY+1*this.matrix[5];return{pageX:b,pageY:c}},globalToLocal:function(a){var b=a.pageX-this.matrix[4],c=a.pageY-this.matrix[5],d=this.matrix[0]*this.matrix[3]-this.matrix[1]*this.matrix[2],e=(this.matrix[3]*b-this.matrix[2]*c)/d,f=(-this.matrix[1]*b+this.matrix[0]*c)/d;return{localX:e,localY:f}},toString:function(){return"rotoZoomer"}},c.debug=!1,a.RotoZoomer=c}(window.TipTap,_),function(a,b,c){var d=function(a){this._setElement$(a),this.listOfCallbacks={},this.listOfFilters=[],this.listOfActions=[],this.hasGlobalCallbacks=!1};d.prototype={addActionListeners:function(a){a.pressed.add(b.bind(this.callComboCallback,this,a),this),a.sendCombo.add(b.bind(this.callComboCallback,this,a),this),a.dragStarted.add(b.bind(this.callComboCallback,this,a),this),a.dragged.add(b.bind(this.callComboCallback,this,a),this),a.dragStopped.add(b.bind(this.callComboCallback,this,a),this),a.released.add(b.bind(this.callComboCallback,this,a),this),a.finished.add(b.bind(this.deallocateAction,this,a),this)},allocateAction:function(b){var c=d.debug&&a.settings.debug,e,f=b.getTarget$();md(this+".allocateAction-1",c),e=this._findActionByTarget(f),e||(md(this+".allocateAction-couldn't find Action by target",c),e=new a.Action(f),md(this+".allocateAction-new Action created",c),this.listOfActions.push(e),this.addActionListeners(e)),e.addPointerListeners(b),md(this+".allocateAction-end("+e+")",c)},_areTheseTheSameNode$:null,_areTheseTheSameNode:function(a,b){return a.isSameNode(b)},_areTheseTheSame$Node:function(a,b){return a.is(b)},bindCombos:function(b,c,e,f){var g;c?this.listOfFilters.push(c):(this.hasGlobalCallbacks=!0,c=a.GLOBAL_CLASS_FILTER),g=d.comboToRegExp(b),this.listOfCallbacks[g]||(this.listOfCallbacks[g]={regex:new RegExp(g),callbacks:[]}),this.listOfCallbacks[g].callbacks.unshift({filter:c,callback:e,context:f})},callComboCallback:function(c,e){var f=d.debug&&a.settings.debug;md("<b>"+this+".callComboCallback("+c+", "+e+", "+c.gesture+")</b>",f);var g=c.getTarget$(),h=this._isElementTheTarget$(g)&&this.hasGlobalCallbacks;b.each(this.listOfCallbacks,function(d){if(d.regex.test(e)){var f=b.find(d.callbacks,function(a){return this._matchesFilter$(g,a.filter)},this);if(!f&&h){var i=a.GLOBAL_CLASS_FILTER;f=b.find(d.callbacks,function(a){return a.filter===i})}f&&f.callback.call(f.context,c)}},this)},deallocateAction:function(b){var c=d.debug&&a.settings.debug;md(this+".deAllocateAction("+b+")",c),this.listOfActions.splice(this.listOfActions.indexOf(b),1)},_isElementTheTarget$:null,_isElementTheTarget:function(a){return a.isSameNode(this.el)},_isElementThe$Target:function(a){return a.is(this.$el)},_findActionByTarget:function(a){return b.find(this.listOfActions,function(b){return this._areTheseTheSameNode$(b.getTarget$(),a)},this)},findMatchingFilterForEvent:function(c){var d=b.find(this.listOfFilters,function(a){return this._matchesFilter$(c,a)},this);return!d&&this.hasGlobalCallbacks?a.GLOBAL_CLASS_FILTER:d},getElement$:null,getElement:function(){return this.el},get$Element:function(){return this.$el},isOnNode$:null,isOnNode:function(a){return this.getElement().isSameNode(a)},isOn$Node:function(a){return this.get$Element().is(a)},_matchesFilter$:null,_matchesFilter:function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>=0},_matches$Filter:function(a,b){return a.is(b)},_setElement$:null,_setElement:function(a){this.el=a},_set$Element:function(a){this.$el=a},toString:function(){return"R"}},d.comboToRegExp=function(c){var e=d.debug&&a.settings.debug;b.each(a.Gesture.statusMatchCode,function(a){c=c.replace(new RegExp(a.code,"g"),a.letter)});var f=c.split(a.settings.comboAlternateOperator),g=[];return b.each(f,function(a){var b=d.transformComboIntoRegex(a);g.push(b)}),g.join("|")};var e=b.reduce(a.Gesture.statusMatchCode,function(a,b){return a+b.letter},"");d.lettersAndSeparatorsRE=new RegExp("["+e+a.settings.comboGesturesSep+a.settings.comboParallelActionOperator+"]"),d.modifiersRE=/[\*\+\?]/,d.modifiersZeroOrRE=/[\*\?]/,d.numbersRE=/[0-9]/,d.recursiveTransformCombo=function(b,c,e){var f=b.charAt(e++),g;if(d.lettersAndSeparatorsRE.test(f)){var h=f,i=0;while(e<=c&&d.numbersRE.test(b.charAt(e)))i=10*i+parseInt(b.charAt(e++),10);if(i>1)h+="{"+i+"}";else if(e<=c){f=b.charAt(e);if(d.modifiersRE.test(f)){var j=f;e++;if(d.modifiersZeroOrRE.test(f)&&e<=c){var k=b.charAt(e)===a.settings.comboParallelActionOperator;k&&(e++,g=d.recursiveTransformCombo(b,c,e))}}}if(k)switch(j){case"?":h="("+g+"|"+h+"(?=-(?="+g+")))";break;case"*":h="("+g+"|"+h+"+(?=-(?="+g+")))";break;case"+":h+="+(?=-(?="+g+"))"}else j&&(h+=j),e<=c?h+="(?=("+d.recursiveTransformCombo(b,c,e)+"))":h+="$";return h}return""},d.transformComboIntoRegex=function(a){var b=a.length-1,c=0;return"^"+d.recursiveTransformCombo(a,b,c)},d.use$=function(a){a?(this.prototype._areTheseTheSameNode$=this.prototype._areTheseTheSame$Node,this.prototype.getElement$=this.prototype.get$Element,this.prototype._isElementTheTarget$=this.prototype._isElementThe$Target,this.prototype.isOnNode$=this.prototype.isOn$Node,this.prototype._matchesFilter$=this.prototype._matches$Filter,this.prototype._setElement$=this.prototype._set$Element):(this.prototype._areTheseTheSameNode$=this.prototype._areTheseTheSameNode,this.prototype.getElement$=this.prototype.getElement,this.prototype._isElementTheTarget$=this.prototype._isElementTheTarget,this.prototype.isOnNode$=this.prototype.isOnNode,this.prototype._matchesFilter$=this.prototype._matchesFilter,this.prototype._setElement$=this.prototype._setElement)},d.debug=!0,a.Router=d}(window.TipTap,_,window.jQuery),function(a){Touch={START_EVENT_NAME:"touchstart",DRAG_EVENT_NAME:"touchmove",END_EVENT_NAME:"touchend",CANCEL_EVENT_NAME:"touchcancel",buildEventList:function(b){var c=this._getTouches$(b),d=[];for(var e=0,f=c.length;e<f;e++){var g=c[e];d.push(new a.TouchEvent(g,b))}return d},_getTouches$:null,_getTouches:function(a){return a.changedTouches},_get$Touches:function(a){return a.originalEvent.changedTouches},onStart:function(a){},onDrag:function(a){},onEnd:function(a){},onCancel:function(a){},use$:function(b){b?this._getTouches$=this._get$Touches:this._getTouches$=this._getTouches,a.TouchEvent.use$(b)},shouldCaptureDrag:function(a){return!0}},a.Touch=Touch}(window.TipTap);